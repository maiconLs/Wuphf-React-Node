{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thema\\\\Documents\\\\Project\\\\frontend\\\\src\\\\pages\\\\Publications\\\\index.tsx\",\n    _s = $RefreshSig$();\n\nimport api from \"../../services/api\";\nimport { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.min.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Publication() {\n  _s();\n\n  const [post, setPost] = useState({});\n  const [preview, setPreview] = useState([]);\n  const [token] = useState(localStorage.getItem(\"token\") || \"\");\n  const navigate = useNavigate();\n  const [user, setUser] = useState({});\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    api.get(\"/users/checkuser\", {\n      headers: {\n        Authorization: `Bearer ${JSON.parse(token)} `\n      }\n    }).then(response => {\n      setUser(response.data);\n    });\n  }, [token]);\n\n  function onFileChange(e) {\n    setPreview(Array.from(e.target.files));\n    setPost({ ...post,\n      images: [...e.target.files]\n    });\n  }\n\n  function handleChange(e) {\n    setPost({ ...post,\n      [e.target.name]: e.target.value\n    });\n    console.log(post);\n  }\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    const formData = new FormData();\n    const postFormData = Object.keys(post).forEach(key => {\n      if (key === \"images\") {\n        for (let i = 0; i < post[key].length; i++) {\n          formData.append(`images`, post[key][i]);\n        }\n      } else {\n        formData.append(key, post[key]);\n      }\n    });\n    formData.append(\"post\", JSON.stringify(postFormData));\n    await api.post(`/publications/createpublication`, formData, {\n      headers: {\n        Authorization: `Bearer ${JSON.parse(token)}`,\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    }).then(response => {\n      navigate(\"/home\");\n      toast.success(\"Post cadastrado com sucesso\");\n      return response.data;\n    }).catch(err => {\n      toast.error(JSON.stringify(err.response.data.message));\n      return err.response.data;\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"container_home\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Publica\\xE7\\xE3o\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: preview.length > 0 ? preview.map((image, index) => /*#__PURE__*/_jsxDEV(\"img\", {\n            src: URL.createObjectURL(image),\n            alt: post.name\n          }, `${post.name}+${index}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 19\n          }, this)) : post.images && post.images.map((image, index) => /*#__PURE__*/_jsxDEV(\"img\", {\n            src: `${process.env.REACT_APP_API}/images/posts/${image}`,\n            alt: post.name\n          }, `${post.name}+${index}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          name: \"images\",\n          multiple: true,\n          onChange: onFileChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"legenda\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Enviar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Publication, \"oRf9lOXAD4svanv115MYKdoRqJk=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Publication;\n\nvar _c;\n\n$RefreshReg$(_c, \"Publication\");","map":{"version":3,"sources":["C:/Users/thema/Documents/Project/frontend/src/pages/Publications/index.tsx"],"names":["api","useState","useNavigate","toast","Publication","post","setPost","preview","setPreview","token","localStorage","getItem","navigate","user","setUser","loading","setLoading","useEffect","get","headers","Authorization","JSON","parse","then","response","data","onFileChange","e","Array","from","target","files","images","handleChange","name","value","console","log","handleSubmit","preventDefault","formData","FormData","postFormData","Object","keys","forEach","key","i","length","append","stringify","success","catch","err","error","message","map","image","index","URL","createObjectURL","process","env","REACT_APP_API"],"mappings":"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","sourcesContent":["import api from \"../../services/api\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nimport Header from \"../../components/index\";\r\n\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.min.css\";\r\n\r\nimport { FiUpload } from \"react-icons/fi\";\r\n\r\ninterface IPost {\r\n  subtitle: string;\r\n  _id: string;\r\n  image: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport default function Publication() {\r\n  const [post, setPost] = useState({} as IPost);\r\n  const [preview, setPreview] = useState([] as any);\r\n  const [token] = useState(localStorage.getItem(\"token\") || \"\");\r\n  const navigate = useNavigate();\r\n\r\n  const [user, setUser] = useState({} as IUser);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n\r\n  useEffect(() => {\r\n    api\r\n      .get(\"/users/checkuser\", {\r\n        headers: {\r\n          Authorization: `Bearer ${JSON.parse(token)} `,\r\n        },\r\n      })\r\n      .then((response) => {\r\n        setUser(response.data);\r\n      });\r\n  }, [token]);\r\n\r\n  function onFileChange(e: any) {\r\n    setPreview(Array.from(e.target.files));\r\n    setPost({ ...post, images: [...e.target.files] });\r\n  }\r\n\r\n  function handleChange(e: any) {\r\n    setPost({ ...post, [e.target.name]: e.target.value });\r\n    console.log(post)\r\n  }\r\n\r\n  async function handleSubmit(e: any) {\r\n    e.preventDefault();\r\n    const formData = new FormData();\r\n\r\n    const postFormData = Object.keys(post).forEach((key) => {\r\n      if (key === \"images\") {\r\n        for (let i = 0; i < post[key].length; i++) {\r\n          formData.append(`images`, post[key][i]);\r\n        }\r\n      } else {\r\n        formData.append(key, post[key]);\r\n      }\r\n    });\r\n\r\n    formData.append(\"post\", JSON.stringify(postFormData));\r\n\r\n    await api\r\n      .post(`/publications/createpublication`, formData, {\r\n        headers: {\r\n          Authorization: `Bearer ${JSON.parse(token)}`,\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      })\r\n      .then((response) => {\r\n        navigate(\"/home\");\r\n        toast.success(\"Post cadastrado com sucesso\");\r\n        return response.data;\r\n      })\r\n      .catch((err) => {\r\n        toast.error(JSON.stringify(err.response.data.message));\r\n        return err.response.data;\r\n      });\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {/* <Header /> */}\r\n      <section className=\"container_home\">\r\n        <h1>Publicação</h1>\r\n        <div>\r\n          <div>\r\n            {preview.length > 0\r\n              ? preview.map((image: Blob | MediaSource, index: any) => (\r\n                  <img\r\n                    src={URL.createObjectURL(image)}\r\n                    alt={post.name}\r\n                    key={`${post.name}+${index}`}\r\n                  />\r\n                ))\r\n              : post.images &&\r\n                post.images.map((image: any, index: any) => (\r\n                  <img\r\n                    src={`${process.env.REACT_APP_API}/images/posts/${image}`}\r\n                    alt={post.name}\r\n                    key={`${post.name}+${index}`}\r\n                  />\r\n                ))}\r\n          </div>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <input type=\"file\" name=\"images\" multiple onChange={onFileChange} />\r\n          <input type=\"text\" name=\"legenda\" onChange={handleChange} />\r\n          <button type=\"submit\">Enviar</button>\r\n        </form>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}